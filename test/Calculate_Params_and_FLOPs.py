import sys
sys.path.insert(1, './')

import cv2
import numpy as np

from core.Define import *
from core.WideResNet import *

from utils.tensorflow_utils import *

input_var = tf.placeholder(tf.float32, [None, IMAGE_SIZE, IMAGE_SIZE, IMAGE_CHANNEL])
is_training = tf.placeholder(tf.bool)

logits, predictions = WideResNet(input_var, is_training, filters = 135, repeat = 4)

vars = tf.trainable_variables()
model_summary(vars, './wider_resnet_28_large.txt')

'''
____________________________________________________________________________________________________
Name                                               Shape                Param #
____________________________________________________________________________________________________
WideResNet/conv2d/kernel:0                         [3, 3, 3, 16]        432
____________________________________________________________________________________________________
WideResNet/conv2d/bias:0                           [16]                 16
____________________________________________________________________________________________________
WideResNet/batch_normalization/gamma:0             [16]                 16
____________________________________________________________________________________________________
WideResNet/batch_normalization/beta:0              [16]                 16
____________________________________________________________________________________________________
WideResNet/conv2d_1/kernel:0                       [3, 3, 16, 135]      19440
____________________________________________________________________________________________________
WideResNet/conv2d_1/bias:0                         [135]                135
____________________________________________________________________________________________________
WideResNet/batch_normalization_1/gamma:0           [135]                135
____________________________________________________________________________________________________
WideResNet/batch_normalization_1/beta:0            [135]                135
____________________________________________________________________________________________________
WideResNet/conv2d_2/kernel:0                       [3, 3, 135, 135]     164025
____________________________________________________________________________________________________
WideResNet/conv2d_2/bias:0                         [135]                135
____________________________________________________________________________________________________
WideResNet/conv2d_3/kernel:0                       [1, 1, 16, 135]      2160
____________________________________________________________________________________________________
WideResNet/conv2d_3/bias:0                         [135]                135
____________________________________________________________________________________________________
WideResNet/batch_normalization_2/gamma:0           [135]                135
____________________________________________________________________________________________________
WideResNet/batch_normalization_2/beta:0            [135]                135
____________________________________________________________________________________________________
WideResNet/conv2d_4/kernel:0                       [3, 3, 135, 135]     164025
____________________________________________________________________________________________________
WideResNet/conv2d_4/bias:0                         [135]                135
____________________________________________________________________________________________________
WideResNet/batch_normalization_3/gamma:0           [135]                135
____________________________________________________________________________________________________
WideResNet/batch_normalization_3/beta:0            [135]                135
____________________________________________________________________________________________________
WideResNet/conv2d_5/kernel:0                       [3, 3, 135, 135]     164025
____________________________________________________________________________________________________
WideResNet/conv2d_5/bias:0                         [135]                135
____________________________________________________________________________________________________
WideResNet/batch_normalization_4/gamma:0           [135]                135
____________________________________________________________________________________________________
WideResNet/batch_normalization_4/beta:0            [135]                135
____________________________________________________________________________________________________
WideResNet/conv2d_6/kernel:0                       [3, 3, 135, 135]     164025
____________________________________________________________________________________________________
WideResNet/conv2d_6/bias:0                         [135]                135
____________________________________________________________________________________________________
WideResNet/batch_normalization_5/gamma:0           [135]                135
____________________________________________________________________________________________________
WideResNet/batch_normalization_5/beta:0            [135]                135
____________________________________________________________________________________________________
WideResNet/conv2d_7/kernel:0                       [3, 3, 135, 135]     164025
____________________________________________________________________________________________________
WideResNet/conv2d_7/bias:0                         [135]                135
____________________________________________________________________________________________________
WideResNet/batch_normalization_6/gamma:0           [135]                135
____________________________________________________________________________________________________
WideResNet/batch_normalization_6/beta:0            [135]                135
____________________________________________________________________________________________________
WideResNet/conv2d_8/kernel:0                       [3, 3, 135, 135]     164025
____________________________________________________________________________________________________
WideResNet/conv2d_8/bias:0                         [135]                135
____________________________________________________________________________________________________
WideResNet/batch_normalization_7/gamma:0           [135]                135
____________________________________________________________________________________________________
WideResNet/batch_normalization_7/beta:0            [135]                135
____________________________________________________________________________________________________
WideResNet/conv2d_9/kernel:0                       [3, 3, 135, 135]     164025
____________________________________________________________________________________________________
WideResNet/conv2d_9/bias:0                         [135]                135
____________________________________________________________________________________________________
WideResNet/batch_normalization_8/gamma:0           [135]                135
____________________________________________________________________________________________________
WideResNet/batch_normalization_8/beta:0            [135]                135
____________________________________________________________________________________________________
WideResNet/conv2d_10/kernel:0                      [3, 3, 135, 270]     328050
____________________________________________________________________________________________________
WideResNet/conv2d_10/bias:0                        [270]                270
____________________________________________________________________________________________________
WideResNet/batch_normalization_9/gamma:0           [270]                270
____________________________________________________________________________________________________
WideResNet/batch_normalization_9/beta:0            [270]                270
____________________________________________________________________________________________________
WideResNet/conv2d_11/kernel:0                      [3, 3, 270, 270]     656100
____________________________________________________________________________________________________
WideResNet/conv2d_11/bias:0                        [270]                270
____________________________________________________________________________________________________
WideResNet/conv2d_12/kernel:0                      [1, 1, 135, 270]     36450
____________________________________________________________________________________________________
WideResNet/conv2d_12/bias:0                        [270]                270
____________________________________________________________________________________________________
WideResNet/batch_normalization_10/gamma:0          [270]                270
____________________________________________________________________________________________________
WideResNet/batch_normalization_10/beta:0           [270]                270
____________________________________________________________________________________________________
WideResNet/conv2d_13/kernel:0                      [3, 3, 270, 270]     656100
____________________________________________________________________________________________________
WideResNet/conv2d_13/bias:0                        [270]                270
____________________________________________________________________________________________________
WideResNet/batch_normalization_11/gamma:0          [270]                270
____________________________________________________________________________________________________
WideResNet/batch_normalization_11/beta:0           [270]                270
____________________________________________________________________________________________________
WideResNet/conv2d_14/kernel:0                      [3, 3, 270, 270]     656100
____________________________________________________________________________________________________
WideResNet/conv2d_14/bias:0                        [270]                270
____________________________________________________________________________________________________
WideResNet/batch_normalization_12/gamma:0          [270]                270
____________________________________________________________________________________________________
WideResNet/batch_normalization_12/beta:0           [270]                270
____________________________________________________________________________________________________
WideResNet/conv2d_15/kernel:0                      [3, 3, 270, 270]     656100
____________________________________________________________________________________________________
WideResNet/conv2d_15/bias:0                        [270]                270
____________________________________________________________________________________________________
WideResNet/batch_normalization_13/gamma:0          [270]                270
____________________________________________________________________________________________________
WideResNet/batch_normalization_13/beta:0           [270]                270
____________________________________________________________________________________________________
WideResNet/conv2d_16/kernel:0                      [3, 3, 270, 270]     656100
____________________________________________________________________________________________________
WideResNet/conv2d_16/bias:0                        [270]                270
____________________________________________________________________________________________________
WideResNet/batch_normalization_14/gamma:0          [270]                270
____________________________________________________________________________________________________
WideResNet/batch_normalization_14/beta:0           [270]                270
____________________________________________________________________________________________________
WideResNet/conv2d_17/kernel:0                      [3, 3, 270, 270]     656100
____________________________________________________________________________________________________
WideResNet/conv2d_17/bias:0                        [270]                270
____________________________________________________________________________________________________
WideResNet/batch_normalization_15/gamma:0          [270]                270
____________________________________________________________________________________________________
WideResNet/batch_normalization_15/beta:0           [270]                270
____________________________________________________________________________________________________
WideResNet/conv2d_18/kernel:0                      [3, 3, 270, 270]     656100
____________________________________________________________________________________________________
WideResNet/conv2d_18/bias:0                        [270]                270
____________________________________________________________________________________________________
WideResNet/batch_normalization_16/gamma:0          [270]                270
____________________________________________________________________________________________________
WideResNet/batch_normalization_16/beta:0           [270]                270
____________________________________________________________________________________________________
WideResNet/conv2d_19/kernel:0                      [3, 3, 270, 540]     1312200
____________________________________________________________________________________________________
WideResNet/conv2d_19/bias:0                        [540]                540
____________________________________________________________________________________________________
WideResNet/batch_normalization_17/gamma:0          [540]                540
____________________________________________________________________________________________________
WideResNet/batch_normalization_17/beta:0           [540]                540
____________________________________________________________________________________________________
WideResNet/conv2d_20/kernel:0                      [3, 3, 540, 540]     2624400
____________________________________________________________________________________________________
WideResNet/conv2d_20/bias:0                        [540]                540
____________________________________________________________________________________________________
WideResNet/conv2d_21/kernel:0                      [1, 1, 270, 540]     145800
____________________________________________________________________________________________________
WideResNet/conv2d_21/bias:0                        [540]                540
____________________________________________________________________________________________________
WideResNet/batch_normalization_18/gamma:0          [540]                540
____________________________________________________________________________________________________
WideResNet/batch_normalization_18/beta:0           [540]                540
____________________________________________________________________________________________________
WideResNet/conv2d_22/kernel:0                      [3, 3, 540, 540]     2624400
____________________________________________________________________________________________________
WideResNet/conv2d_22/bias:0                        [540]                540
____________________________________________________________________________________________________
WideResNet/batch_normalization_19/gamma:0          [540]                540
____________________________________________________________________________________________________
WideResNet/batch_normalization_19/beta:0           [540]                540
____________________________________________________________________________________________________
WideResNet/conv2d_23/kernel:0                      [3, 3, 540, 540]     2624400
____________________________________________________________________________________________________
WideResNet/conv2d_23/bias:0                        [540]                540
____________________________________________________________________________________________________
WideResNet/batch_normalization_20/gamma:0          [540]                540
____________________________________________________________________________________________________
WideResNet/batch_normalization_20/beta:0           [540]                540
____________________________________________________________________________________________________
WideResNet/conv2d_24/kernel:0                      [3, 3, 540, 540]     2624400
____________________________________________________________________________________________________
WideResNet/conv2d_24/bias:0                        [540]                540
____________________________________________________________________________________________________
WideResNet/batch_normalization_21/gamma:0          [540]                540
____________________________________________________________________________________________________
WideResNet/batch_normalization_21/beta:0           [540]                540
____________________________________________________________________________________________________
WideResNet/conv2d_25/kernel:0                      [3, 3, 540, 540]     2624400
____________________________________________________________________________________________________
WideResNet/conv2d_25/bias:0                        [540]                540
____________________________________________________________________________________________________
WideResNet/batch_normalization_22/gamma:0          [540]                540
____________________________________________________________________________________________________
WideResNet/batch_normalization_22/beta:0           [540]                540
____________________________________________________________________________________________________
WideResNet/conv2d_26/kernel:0                      [3, 3, 540, 540]     2624400
____________________________________________________________________________________________________
WideResNet/conv2d_26/bias:0                        [540]                540
____________________________________________________________________________________________________
WideResNet/batch_normalization_23/gamma:0          [540]                540
____________________________________________________________________________________________________
WideResNet/batch_normalization_23/beta:0           [540]                540
____________________________________________________________________________________________________
WideResNet/conv2d_27/kernel:0                      [3, 3, 540, 540]     2624400
____________________________________________________________________________________________________
WideResNet/conv2d_27/bias:0                        [540]                540
____________________________________________________________________________________________________
WideResNet/batch_normalization_24/gamma:0          [540]                540
____________________________________________________________________________________________________
WideResNet/batch_normalization_24/beta:0           [540]                540
____________________________________________________________________________________________________
WideResNet/dense/kernel:0                          [540, 10]            5400
____________________________________________________________________________________________________
WideResNet/dense/bias:0                            [10]                 10
____________________________________________________________________________________________________
Total Params : 25,985,290, 25M
____________________________________________________________________________________________________
'''